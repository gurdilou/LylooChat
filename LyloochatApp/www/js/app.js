function App(t){function e(){for(this.model.listCards=new ListCards,i=0;i<16;i++){var e=t.loadCard(i);this.model.listCards.addCard(e)}}this.loaded=!1,this.views={},this.model={},this.deviceHandler=t,Handlebars.registerPartial("widget_badge_button",Lyloochat.templates.widget_badge_button),Handlebars.registerPartial("widget_text_button",Lyloochat.templates.widget_text_button),Handlebars.registerPartial("widget_floating_button",Lyloochat.templates.widget_floating_button),this.initialisation=function(){console.log("initialisation"),e.call(this),this.views.menu=new AppMenu(this),this.views.grid=new AppGrid(this),this.loaded=!0,window.onerror=function(t,e,n,i,a){console.error(t),showErrorPanel(t)}}}function showMaskPanel(t){$.inner_showMaskPanel(this,t)}function hideMaskPanel(){$.inner_hideMaskPanel(this)}function showErrorPanel(t){$.inner_showErrorPanel(this,t,hideErrorPanel)}function hideErrorPanel(){$.inner_hideErrorPanel(this)}function Card(t,e){this.id=t,this.code=e}function Card_Drawing(t,e,n){this.svg=n,Card.apply(this,[t,e])}function Card_Sound(t,e,n){this.filepath=n,Card.apply(this,[t,e])}function Card_Text(t,e,n){this.label=n,Card.apply(this,[t,e])}function ListCards(){this.cards=[],this.addCard=function(t){this.cards.push(t)},this.length=function(){return this.cards.length},this.getCard=function(t){return this.cards[t]}}function AppGrid(t){function e(){var e=document.getElementById("grid-cards");for(i=0;i<t.model.listCards.length();i++){var o,r=t.model.listCards.getCard(i);if(r instanceof Card_Text?o=new Widget_Card_Text(r):r instanceof Card_Drawing?o=new Widget_Card_Drawing(r):r instanceof Card_Sound&&(o=new Widget_Card_Sound(r)),"undefined"==typeof o)throw"Type de carte non supportÃ© encore.";o.render(e)}n(),a()}function n(){var t,e,n,i,a;$(".ripple").on("tap",function(o){var r=phonegapHandler.app;r.loaded&&(t=$(this),0===t.find(".ink").length&&t.prepend("<span class='ink'></span>"),e=t.find(".ink"),e.removeClass("animate"),e.height()||e.width()||(n=Math.max(t.outerWidth(),t.outerHeight()),e.css({height:n,width:n})),i=o.pageX-t.offset().left-e.width()/2,a=o.pageY-t.offset().top-e.height()/2,e.css({top:a+"px",left:i+"px"}).addClass("animate"))})}function a(){$(".card-text").on("taphold",function(t){var e=phonegapHandler.app;if(e.loaded){void 0===e.views.cardConfigurator&&(e.views.cardConfigurator=new CardConfigurator);var n=$(this);e.views.cardConfigurator.onClick(n,t)}})}this.app=t,e()}function AppMenu(t){function e(){var t=document.getElementById("appmenu"),e={name:"Lyloochat",icon:"play",links:[{longCode:"Afficher un texte",code:"Texte",icon:"keyboard"},{longCode:"Jouer un son",code:"Son",icon:"play"},{longCode:"Dessiner quelquechose",code:"Dessin",icon:"pen"},{longCode:"Changer les options",code:"Options",icon:"settings"}]};t.innerHTML=Lyloochat.templates.widget_menus(e)}this.app=t,e()}function CardConfigurator(){function t(){this.busy=!1,this.elementSelect=void 0,hideMaskPanel()}function e(){var t=$(".mask");t.html("<div class='cardConfigurator-button-ctn'></div>");var e=t.find(".cardConfigurator-button-ctn"),a={"class":"butt-edit",title:"Editer l'item",icon:"edit",code:"Editer"};e.html(Lyloochat.templates.widget_badge_button(a));var o=$(".badge-button.butt-edit");o.on("click",i),a={"class":"butt-delete",title:"Supprimer l'item",icon:"delete",code:"Supprimer"},e.append(Lyloochat.templates.widget_badge_button(a));var r=$(".badge-button.butt-delete");r.on("click",n)}function n(t){console.log("_on_deleteItem"),t.stopPropagation()}function i(t){console.log("_on_editItem"),t.stopPropagation()}this.onClick=function(n,i){if(!this.busy){this.busy=!0,this.elementSelect=n,showMaskPanel.call(this,t);$(window).width();e.call(this)}}}function Widget_Card(t){function e(){var t=this,e=$(this.elem_card).find(".container");e.on("tap",function(){setTimeout(function(){t.onCardThumbnailClick()},300)})}this.card=t,this.elem_card=void 0,this.fullscreen_card=void 0,this.getCardThumbailContent=function(){return showErrorPanel("Shouldn't be there you naughty boy !"),""},this.onCardThumbnailClick=function(){showErrorPanel("Shouldn't be there you naughty boy !")},this.render=function(t){$(t).append(this.getCardThumbailContent.call(this));var n=t.lastElementChild;return this.elem_card=n,e.call(this),""}}function Widget_Card_Drawing(t){Widget_Card.apply(this,[t]),this.getCardThumbailContent=function(){var e={cardNumber:t.id,title:t.code};return Lyloochat.templates.widget_card_text(e)},this.onCardThumbnailClick=function(){showErrorPanel("Click Widget_Card_Drawing")}}function Widget_Card_Text(t){Widget_Card.apply(this,[t]),this.getCardThumbailContent=function(){var e={cardNumber:t.id,title:t.code};return Lyloochat.templates.widget_card_text(e)},this.onCardThumbnailClick=function(){this.displayed_screen_card=new Screen_Card_Text(this),this.displayed_screen_card.display()}}function Screen_Card(t){this.widget_card=t,this.display=function(){showErrorPanel("Shouldn't be there you naughty boy !")}}function Screen_Card_Drawing(t){Screen_Card.apply(this,[t])}function Screen_Card_Sound(t){Screen_Card.apply(this,[t])}function Screen_Card_Text(t){Screen_Card.apply(this,[t]),this.display=function(){var e=$("body"),n={label:t.card.label},i=Lyloochat.templates.screen_display_card_text(n);e.append(i);var a=e.children().last(),o=a.find(".container");o.boxfit(),$(window).resize(function(){a.attr("style",""),o.attr("style",""),o.boxfit()});var r=a.find(".card-fs-butt-ok");r.on("click",function(t){$(a).remove()})}}!function(t,e){e.inner_showMaskPanel=function(t,n){var i=e(".mask");i.html(""),i.addClass("visible"),i.on("click",function(e){n.call(t)})},e.inner_hideMaskPanel=function(t){var n=e(".mask");n.html(""),n.removeClass("visible"),n.off("click")},e.inner_showErrorPanel=function(t,n){e.inner_showMaskPanel(this,hideErrorPanel);var i=e(".mask"),a={type:"error",header:{icon:"sad",message:"Onoz !"},messages:[n],footer:{buttons:["ok"]}};i.html(Lyloochat.templates.widget_dialog(a))},e.inner_hideErrorPanel=function(t){e.inner_hideMaskPanel(t)}}(window,jQuery),Handlebars.registerHelper("if_eq",function(t,e,n){return t===e?n.fn(this):n.inverse(this)});